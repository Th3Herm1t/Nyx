import joblib
from nltk.tokenize import word_tokenize
from nltk.corpus import stopwords
from nltk.stem import PorterStemmer
from tqdm import tqdm  # tqdm for progress logging
import nltk

# Sample text processing function
def tokenize_and_clean_with_progress(text):
    # Tokenize
    tokens = word_tokenize(text)
    
    # Remove stop words
    tokens = [word for word in tokens if word.lower() not in stopwords.words('english')]
    
    # Stemming
    stemmer = PorterStemmer()
    tokens = [stemmer.stem(word) for word in tokens]
    
    return tokens


def predict_mbti(text):
    # Load the TF-IDF vectorizer and SVM model
    vectorizer = joblib.load('/workspaces/Nyx/vectorizer.joblib')
    svm_model = joblib.load('/workspaces/Nyx/svm_model1.pkl')
    
    tokens = tokenize_and_clean_with_progress(text)

    # Transform the input text using the vectorizer
    text_for_prediction = ' '.join(tokens)  # Combine tokens into a space-separated string
    text_vectorized = vectorizer.transform([text_for_prediction])  # Pass a list with a single string

    # Make predictions using the SVM model
    predicted_mbti = svm_model.predict(text_vectorized)[0]

    return predicted_mbti

print(predict_mbti("Nobody is the same so realistically it's 100% impossible to base anyone off of stereotypes. every single person ever born is an individual. Dumb question.  Some are cool, some are annoying.  just...|||1. Creativity 2. Curiosity, 3. Honesty, 4. Learning, 5. Perspective............  Pretty much everything. im awesome.  Although no weakness given, can improve every aspect of my life.  Self...|||I know a stereotypical ISTP is supposedly a lone wolf.... which i agree with.  however I am without any doubt whatso ever a leader, although i have absolutely no problem collaborating with someone...|||haha whaaaa?  im from cheyenne.... actually laramie now. small world.|||Biggest rush was a 17 story bungee jump over concrete. where the spotter held me backwards, horizontally to the ground and dropped me at random so i had absolutely no expectation to when i was gonna...|||Strange.|||Ive been diagnosed as Bipolar-II.  i used to doubt it... till i went off mood-stabilizers.  Don't know if this really has anything to do with personally types though.  I'm sure mood disorders happen...|||You need to talk more........ I've just started simply saying no.  it annoys the hell out of me.|||I do whatever the fuck i want and then get arrested.  I stopped going to bars....... but i got laid, a lot.|||Officially an oil driller (roughneck) in Bismark, ND.... makin 2 grand every other week.|||Listen to exactly what they say, not in between the lines.  And if they talk to you more so than not we probably consider you a friend.  but to be honest, you have some weird ass questions.|||You can't.|||Nope.  he hit em, ran them over.  id beat him.|||LOL, a car hit him.... and ran over 5 more of my buddies.  Yes i would beat the shit out of him.  hahahhahahhaa troll.|||If my best buddy got hit by a car, id fuck em up.  prove me wrong.  What a judgmental d bag you are.|||lmfao, if my buddy got hit by a car, id fuck the driver up.  prove me wrong.|||Neither do I.  Buttfuckit.... no pun intended.|||fuck the police.|||NO, one biker slowed down to let him know he cut another off and the fucking driver swiped him and drove like 5 other bikers over out of panic.  id  beat the fuck out of him.  I bike, and that shits...|||From my understanding, pain tolerance has nothing to do with 'toughness.'  I think istp's are tough, but every type can have a high 'pain tolerance.'  Pain tolerance is subjective.  I personally have...|||I saw the video, and felt the motorcyclists had every right to beat the shit out of that dude... Who the fuck runs people down with a car???  fuck them.  I'd beat the shit out of them too.|||I usually just say the words 'god damn it' or 'fuck', or a mixture of both.... ex, 'god fucking damn it.'|||I'm the guy who gets along with everyone and it takes a lot to piss me off (although when i do get pissed all hell breaks loose.).  I'm not judgmental and don't jump to conclusions to whether i like...|||This is more of a venting post more than anything but this is absolutely unbelievable.  This is about a crook who is about as smart as a box of rocks and police who aren't much smarter....  A few...|||I used to feel like a zombie, now i just find ways to scare the shit out of myself regularly.  Usually snowboarding or rock climbing.  A lot of times just getting out and fishing or even offroading...|||My left ear is completely clogged.  Not being able to hear out of one ear is the MOST annoying thing ever.|||I once had 3 one night stands in a row.  The first two were great. I just got up in the morning, said bye, and walked home.  the third was pretty uncomfortable because i woke up alone on the couch...|||I also think people envy our rationality and mystery.  When we feel the need to say something important, people listen.  I've noticed too many times people tune out really extroverted types of...|||Sometimes i really need to get away.  My favorite thing is to drive up to the mountains and fly fish trout in very remote areas.  I actually prefer to fish alone because fly fishing is like a puzzle...|||I used to be pretty wild, like 8 months ago. Then i got arrested, totaled my truck, and got a shit load of misdemeanor driving tickets.  License suspension, fines, tow bills, and multi-year probation...|||Damn i live in a beautiful state.  A couple of my pictures.  7210272103  Don't have any of my pics of the Tetons on my computer, but grand teton national park might be my favorite place ever. ...|||Attractive, relatively low maintenance, adventurous, of at least average intelligence, passive but confident, and fun.|||Honestly you can't speculate a group of people.  Ive met some really annoying intj's and some cool ones just like any type.|||The picture is obviously 2/3 empty or 1/3 full.  same thing.|||Yeah i can relate.  It kinda builds up like a pressure and explodes out for the better or worse.  You should keep it private though and like someone said above don't go telling friends and stuff...|||Travis Rice, greatest snowboarder all time.   The dude is insanely good.  He disappeared in an avalanche but somehow kept an edge and rode out the side.  unbelievable.  ...|||I forgot, i think the majority of unfamiliar people find my facial expression intimidating because when we make eye contact they almost always look down.  It must be the blank stare.|||My sister swears I'm OCD, not organizationally but by my way of doing things.  I just have mastered the most efficient way of doing everyday things.  Getting dressed out of order wouldn't annoy me...|||I can certainly relate to this. I'd rather use Se than anything but would definitely prefer to fix/build a car, house, really anything over a stressful relationship issue (prefer, not rather).  But i...|||White water rafting (tried to get into that class for 3 years but was always full), rock climbing, and archery.|||What is that suppose to mean? A true friend is someone who understands and values their friends needs.  not everyone has the same needs.  I have good friends where emotions are rarely, if ever talked...|||I dont think being an istp is a curse or a bad thing.  Honestly i live by my own ethics, rules, and laws. This sometimes does cause minor legal or social issues but luckily i have good morals...|||I would consider myself confident and fairly good looking and really dont have a problem when it comes to getting a first date.  However, i am really slow to open up to new people and by the time i...|||Depends, if its stupid pointless drama i ignore it like the plague.  If it's something truly worth giving a fuck about i have no problems being confrontational.|||I think people are drawn to me as a leader because i am quite but when i talk, i speak the truth.   i guess i walk the walk with out talking much talk.|||I really dont care what people think about me, but i think perceptions about me are different in different settings.  At work, people probably think im fairy outgoing because i am a good sales man...|||I am reserved but am really not shy.  If i think she's my type of girl, ill approach her confidently and start up a conversation.  I dont have any friends 'wing man' for me, i just take it on myself....|||I dont mind it really, especially if it leads to something more :cool:.  im not the best at showing affection through words, so physical touch is easier for me.|||I am majoring in freshwater Fisheries Biology. pretty self explanatory, i plan on being a fisheries biologist.  I've grown up on the water and on boats.  I job shadowed a fisheries biologist in high...|||Crazy - sums up the chick from my first relationship.  ISFP (most likely) - This was more of a fling. she was cool but wasn't exactly the smartest person ive ever met.  I kind of pissed her off..."))


